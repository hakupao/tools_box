# Tools Box 用户手册

本手册详细介绍了工具箱中所有工具的使用方法和注意事项。

## 目录

1. [日期转换工具](#日期转换工具)
2. [CSV转XLSX工具](#csv转xlsx工具)
3. [XLSX转CSV工具](#xlsx转csv工具)
4. [全角转半角工具](#全角转半角工具)
5. [数据清洗工具](#数据清洗工具)
6. [Codelist处理工具](#codelist处理工具)
7. [数据模糊化工具](#数据模糊化工具)
8. [CSV引号去除工具](#csv引号去除工具)
9. [EDC站点添加工具](#edc站点添加工具)
10. [生成Data Set工具](#生成data-set工具)

---

## 日期转换工具

### 功能说明
支持多种日期格式的智能转换，可以将各种格式的日期转换为ISO 8601标准格式。

### 使用方法
1. 点击主界面的"日期转换"按钮
2. 在左侧输入框中输入需要转换的日期
3. 系统会自动识别日期格式并在右侧显示转换结果
4. 支持的格式包括：YYYY-MM-DD、DD/MM/YYYY、MM/DD/YYYY等

### 注意事项
- 输入的日期格式需要是常见的标准格式
- 不完整的日期会显示警告信息

---

## CSV转XLSX工具

### 功能说明
将CSV文件批量转换为Excel (.xlsx) 格式，保持所有数据为文本格式。

### 使用方法
1. 点击主界面的"CSV转XLSX"按钮
2. 选择文件或拖拽CSV文件到窗口
3. 设置输出路径（可选）
4. 点击"开始转换"按钮
5. 查看转换进度和结果

### 支持的功能
- 批量文件处理
- 拖拽操作
- 自定义输出路径
- 实时进度显示
- UTF-8编码支持

---

## XLSX转CSV工具

### 功能说明
将Excel文件批量转换为CSV格式，使用UTF-8-SIG编码确保中文正确显示。

### 使用方法
1. 点击主界面的"XLSX转CSV"按钮
2. 选择Excel文件或拖拽文件到窗口
3. 设置输出路径（可选）
4. 点击"开始转换"按钮

### 特性
- 保持NA值不变
- 自动处理多个工作表
- UTF-8-SIG编码
- 支持.xlsx和.xls格式

---

## 全角转半角工具

### 功能说明
将Excel文件中的全角字符（数字、字母、符号）转换为半角字符。

### 使用方法
1. 点击主界面的"全角转半角"按钮
2. 选择Excel文件或拖拽文件到窗口
3. 设置输出路径（可选）
4. 点击"开始转换"按钮

### 转换范围
- 全角数字：０-９ → 0-9
- 全角英文：Ａ-Ｚ，ａ-ｚ → A-Z，a-z
- 全角符号：！、？、（）等 → !、?、()等
- 全角空格：　→ 空格

---

## 数据清洗工具

### 功能说明
基于仕样书规则进行数据清洗，包括患者过滤、字段裁剪和行过滤。

### 使用方法
1. 点击主界面的"数据清洗"按钮
2. 首先上传仕样书Excel文件
3. 选择需要清洗的CSV文件
4. 设置输出路径（可选）
5. 点击"开始转换"按钮

### 仕样书格式要求
- **Patients表**：包含SUBJID和MIGRATIONFLAG列
- **Process表**：包含FILENAME、FIELDNAME和MIGRATIONFLAG列
- MIGRATIONFLAG标记值：○、〇、◯

### 清洗规则
- 只保留MIGRATIONFLAG标记的患者和字段
- 应用自定义行过滤逻辑
- 删除空行数据
- 输出文件添加"C-"前缀

---

## Codelist处理工具

### 功能说明
根据Codelist文件进行编码映射，将代码转换为对应的值或多语言标签。

### 使用方法
1. 点击主界面的"Codelist处理"按钮
2. 首先上传Codelist Excel文件
3. 选择需要处理的CSV文件
4. 设置输出路径（可选）
5. 点击"开始处理"按钮

### Codelist格式要求
- **Process表**：定义字段映射规则
- **CodeList表**：包含编码映射关系
- **Files表**：定义SUBJID字段映射

### 处理功能
- 编码到值的自动映射
- 多语言值转换
- 日期格式标准化
- SUBJID字段重命名
- 输出文件添加"F-"前缀

---

## 数据模糊化工具

### 功能说明
对SDTM数据集进行隐私保护处理，包括年龄减值、日期模糊化等。

### 使用方法
1. 点击主界面的"数据模糊化"按钮
2. 选择需要模糊化的CSV文件
3. 设置输出路径（可选）
4. 点击"开始处理"按钮

### 模糊化规则
- 年龄字段减2岁
- 基于DM.csv的USUBJID列表过滤（前100条）
- 保持数据一致性的映射机制
- 支持自定义模糊化规则

### 注意事项
- 建议先设置基准USUBJID列表
- 模糊化后的数据仍保持逻辑一致性

---

## CSV引号去除工具

### 功能说明
智能检测并移除CSV文件中字段的多余引号，清理数据格式。

### 使用方法
1. 点击主界面的"CSV引号去除"按钮
2. 选择CSV文件或拖拽文件到窗口
3. 点击"开始处理"按钮（默认覆盖原文件）

### 处理能力
- 智能检测引号类型
- 处理多层引号嵌套
- 自动处理引号转义
- 保持CSV结构不变

### 注意事项
- 工具会直接覆盖原CSV文件
- 处理前建议备份重要文件

---

## EDC站点添加工具

### 功能说明
自动化EDC系统的站点批量添加，通过模拟鼠标点击完成重复操作。

### 使用方法
1. 准备Excel文件，包含站点名称列表
2. 打开Chrome浏览器并登录EDC系统
3. 在Excel中选中第一个站点名称单元格
4. 点击主界面的"EDC施设添加"按钮
5. 点击"开始处理"按钮
6. 按ESC键可随时终止处理

### 配置要求
- Excel文件包含站点名称
- Chrome浏览器已登录EDC系统
- 界面按钮位置与配置坐标匹配

### 安全提示
- 处理过程中请勿操作鼠标键盘
- 可使用"配置参数"调整点击坐标
- ESC键为紧急停止按钮

---

## 生成Data Set工具

### 功能说明
将XLSX文件重构为标准CDISC SDTM格式的CSV文件，支持多表合并和字段补全。

### 使用方法
1. 点击主界面的"生成Data Set"按钮
2. 选择符合规范的XLSX文件
3. 可选择上传仕样书进行患者过滤
4. 设置输出路径（可选）
5. 选择STUDYID（默认CIRCULATE）
6. 点击"开始转换"按钮

### 文件要求
- 文件名以字母开头（如AB.xlsx、CM.xlsx）
- 工作表命名规范：域名+数字或Sheet+数字
- 包含标准CDISC字段

### 处理功能
- 多表数据合并
- 字段自动补全和排序
- 序号字段自动生成
- 日期格式标准化
- 患者数据过滤（基于仕样书）

详细的文件制作规范请参考 [XLSX文件制作规范.md](XLSX文件制作规范.md)

---

## 常见问题

### Q: 程序运行出错怎么办？
A: 检查文件格式是否正确，确保文件路径不包含特殊字符，重启程序重试。

### Q: 为什么拖拽文件没有反应？
A: 确保拖拽的文件格式正确，窗口处于活动状态，重新尝试拖拽操作。

### Q: 转换后的文件在哪里？
A: 如果没有设置输出路径，文件会输出到原文件所在目录；如果设置了输出路径，文件会保存到指定目录。

### Q: 如何提高处理速度？
A: 避免同时处理过多文件，关闭不必要的程序，确保有足够的内存空间。

---

## 技术支持

如果在使用过程中遇到问题，请：

1. 检查本手册中的相关说明
2. 查看错误提示信息
3. 确认文件格式符合要求
4. 联系技术支持团队

**联系方式**: [待添加] 